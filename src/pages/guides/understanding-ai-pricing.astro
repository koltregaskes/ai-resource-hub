---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getLLMModels } from '../../data/llm-models';

const models = getLLMModels();
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;

function formatPrice(price: number): string {
  if (price === 0) return 'Free';
  if (price < 0.01) return `$${price.toFixed(4)}`;
  if (price < 1) return `$${price.toFixed(3)}`;
  return `$${price.toFixed(2)}`;
}

// Get a range of prices for examples
const priceRange = models
  .filter(m => m.inputPrice > 0)
  .sort((a, b) => {
    const aCost = (a.inputPrice + 3 * a.outputPrice) / 4;
    const bCost = (b.inputPrice + 3 * b.outputPrice) / 4;
    return aCost - bCost;
  });
const cheapest = priceRange[0];
const mostExpensive = priceRange[priceRange.length - 1];
---

<BaseLayout
  title="Understanding AI Pricing: Tokens, Tiers & Value — The AI Resource Hub"
  description="What are tokens? Why does AI cost money? Free vs paid tiers explained. How to estimate your costs and find the best value."
>
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
    <nav class="text-xs text-(--color-text-muted) mb-4" aria-label="Breadcrumb">
      <a href={base} class="hover:text-(--color-text-secondary) transition-colors">Home</a>
      <span class="mx-2">/</span>
      <a href={`${base}guides/`} class="hover:text-(--color-text-secondary) transition-colors">Guides</a>
      <span class="mx-2">/</span>
      <span class="text-(--color-text-secondary)">Understanding AI Pricing</span>
    </nav>

    <header class="mb-10">
      <div class="flex items-center gap-2 mb-3">
        <span class="text-xs px-2 py-0.5 rounded-full bg-green-500/10 text-green-400">Beginner</span>
        <span class="text-xs text-(--color-text-muted)">7 min read</span>
      </div>
      <h1 class="text-3xl sm:text-4xl font-extrabold text-(--color-text-primary) mb-4">
        Understanding AI Pricing
      </h1>
      <p class="text-lg text-(--color-text-secondary)">
        Tokens, tiers, input vs output — AI pricing can seem confusing.
        Here's everything you need to understand how much AI costs and how to get the best value.
      </p>
    </header>

    <div class="space-y-8">
      <section>
        <h2 class="text-2xl font-bold text-(--color-text-primary) mb-4">What Are Tokens?</h2>
        <p class="text-(--color-text-secondary) leading-relaxed mb-4">
          AI models don't read words — they read <strong class="text-(--color-text-primary)">tokens</strong>.
          A token is roughly 3-4 characters, or about 75% of a word in English. Here's what that means in practice:
        </p>

        <div class="grid sm:grid-cols-3 gap-3 mb-4">
          <div class="p-4 rounded-xl bg-(--color-bg-card) border border-(--color-border) text-center">
            <p class="text-2xl font-bold text-(--color-accent)">~750</p>
            <p class="text-sm text-(--color-text-muted)">words per 1,000 tokens</p>
          </div>
          <div class="p-4 rounded-xl bg-(--color-bg-card) border border-(--color-border) text-center">
            <p class="text-2xl font-bold text-(--color-accent)">~4</p>
            <p class="text-sm text-(--color-text-muted)">pages per 1,000 tokens</p>
          </div>
          <div class="p-4 rounded-xl bg-(--color-bg-card) border border-(--color-border) text-center">
            <p class="text-2xl font-bold text-(--color-accent)">~1.3</p>
            <p class="text-sm text-(--color-text-muted)">tokens per word (average)</p>
          </div>
        </div>

        <p class="text-(--color-text-secondary) leading-relaxed">
          So if you send a 500-word email to an AI and it writes a 300-word reply, that's roughly
          670 input tokens and 400 output tokens.
        </p>
      </section>

      <section>
        <h2 class="text-2xl font-bold text-(--color-text-primary) mb-4">Why Input and Output Are Priced Differently</h2>
        <p class="text-(--color-text-secondary) leading-relaxed mb-4">
          Most AI APIs charge separately for input tokens (what you send) and output tokens (what the AI writes back).
          Output tokens are almost always more expensive because generating new text requires more computation than reading it.
        </p>

        <div class="p-4 rounded-xl bg-(--color-accent-glow) border border-(--color-accent)/20 mb-4">
          <p class="text-sm text-(--color-text-primary)">
            <strong>Think of it like a consultant:</strong> Reading your brief (input) takes less effort than writing
            the deliverable (output). AI pricing reflects this same dynamic.
          </p>
        </div>

        {cheapest && mostExpensive && (
          <p class="text-(--color-text-secondary) leading-relaxed">
            Currently, prices range from <strong class="text-(--color-success)">{formatPrice(cheapest.inputPrice)}</strong> per
            million input tokens ({cheapest.name}) to <strong class="text-(--color-danger)">{formatPrice(mostExpensive.inputPrice)}</strong> per
            million input tokens ({mostExpensive.name}). That's a {Math.round(mostExpensive.inputPrice / cheapest.inputPrice)}x
            difference — so choosing the right model matters.
          </p>
        )}
      </section>

      <section>
        <h2 class="text-2xl font-bold text-(--color-text-primary) mb-4">How Much Does Typical Usage Cost?</h2>
        <p class="text-(--color-text-secondary) leading-relaxed mb-4">
          For most individual users, the costs are remarkably low. Here are some real-world examples:
        </p>

        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b border-(--color-border)">
                <th class="text-left py-3 px-3 text-(--color-text-muted) font-medium">Task</th>
                <th class="text-right py-3 px-3 text-(--color-text-muted) font-medium">~Tokens</th>
                <th class="text-right py-3 px-3 text-(--color-text-muted) font-medium">Cost (cheap)</th>
                <th class="text-right py-3 px-3 text-(--color-text-muted) font-medium">Cost (premium)</th>
              </tr>
            </thead>
            <tbody>
              <tr class="border-b border-(--color-border)/50">
                <td class="py-3 px-3 text-(--color-text-primary)">Quick question & answer</td>
                <td class="py-3 px-3 text-right text-(--color-text-secondary)">500</td>
                <td class="py-3 px-3 text-right text-(--color-success)">< $0.001</td>
                <td class="py-3 px-3 text-right text-(--color-text-primary)">$0.01</td>
              </tr>
              <tr class="border-b border-(--color-border)/50">
                <td class="py-3 px-3 text-(--color-text-primary)">Email draft</td>
                <td class="py-3 px-3 text-right text-(--color-text-secondary)">1,500</td>
                <td class="py-3 px-3 text-right text-(--color-success)">< $0.01</td>
                <td class="py-3 px-3 text-right text-(--color-text-primary)">$0.03</td>
              </tr>
              <tr class="border-b border-(--color-border)/50">
                <td class="py-3 px-3 text-(--color-text-primary)">Blog post (1,000 words)</td>
                <td class="py-3 px-3 text-right text-(--color-text-secondary)">3,000</td>
                <td class="py-3 px-3 text-right text-(--color-success)">$0.01</td>
                <td class="py-3 px-3 text-right text-(--color-text-primary)">$0.06</td>
              </tr>
              <tr class="border-b border-(--color-border)/50">
                <td class="py-3 px-3 text-(--color-text-primary)">Summarise a 10-page document</td>
                <td class="py-3 px-3 text-right text-(--color-text-secondary)">5,000</td>
                <td class="py-3 px-3 text-right text-(--color-success)">$0.01</td>
                <td class="py-3 px-3 text-right text-(--color-text-primary)">$0.08</td>
              </tr>
              <tr>
                <td class="py-3 px-3 text-(--color-text-primary)">Analyse a full book</td>
                <td class="py-3 px-3 text-right text-(--color-text-secondary)">100,000</td>
                <td class="py-3 px-3 text-right text-(--color-success)">$0.10</td>
                <td class="py-3 px-3 text-right text-(--color-text-primary)">$1.50</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section>
        <h2 class="text-2xl font-bold text-(--color-text-primary) mb-4">Consumer Subscriptions vs API Pricing</h2>
        <p class="text-(--color-text-secondary) leading-relaxed mb-4">
          There are two ways to pay for AI:
        </p>

        <div class="grid sm:grid-cols-2 gap-4 mb-4">
          <div class="p-5 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) mb-3">Subscription (Consumer)</h3>
            <ul class="text-sm text-(--color-text-secondary) space-y-2">
              <li><strong>ChatGPT Plus:</strong> $20/month</li>
              <li><strong>Claude Pro:</strong> $20/month</li>
              <li><strong>Gemini AI Ultra:</strong> $20/month</li>
            </ul>
            <p class="text-xs text-(--color-text-muted) mt-3">
              Fixed monthly fee, unlimited (or high-limit) usage. Best for individual users who want a simple chat interface.
            </p>
          </div>
          <div class="p-5 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) mb-3">API (Developer)</h3>
            <ul class="text-sm text-(--color-text-secondary) space-y-2">
              <li><strong>Pay per token:</strong> exact usage billing</li>
              <li><strong>Multiple models:</strong> choose price/quality tradeoff</li>
              <li><strong>Full control:</strong> temperature, system prompts, etc.</li>
            </ul>
            <p class="text-xs text-(--color-text-muted) mt-3">
              Pay only for what you use. Best for developers building applications, or power users who want fine-grained control.
            </p>
          </div>
        </div>

        <p class="text-sm text-(--color-text-muted)">
          See all current API prices: <a href={`${base}compare/llm/`} class="text-(--color-accent) hover:text-(--color-accent-hover) transition-colors">LLM Comparison Table</a>
        </p>
      </section>

      <section>
        <h2 class="text-2xl font-bold text-(--color-text-primary) mb-4">How to Get the Best Value</h2>
        <div class="space-y-3">
          <div class="p-4 rounded-lg bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) text-sm mb-1">1. Use the right model for the job</h3>
            <p class="text-sm text-(--color-text-secondary)">Don't use a $15/1M token model for simple tasks. Use a cheap model for routine work and reserve premium models for hard problems.</p>
          </div>
          <div class="p-4 rounded-lg bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) text-sm mb-1">2. Write concise prompts</h3>
            <p class="text-sm text-(--color-text-secondary)">Every word in your prompt costs tokens. Be specific but not repetitive. Remove filler text.</p>
          </div>
          <div class="p-4 rounded-lg bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) text-sm mb-1">3. Set max output limits</h3>
            <p class="text-sm text-(--color-text-secondary)">Tell the AI to keep responses concise. "In 3 sentences..." saves tokens compared to getting a 5-paragraph essay.</p>
          </div>
          <div class="p-4 rounded-lg bg-(--color-bg-card) border border-(--color-border)">
            <h3 class="font-semibold text-(--color-text-primary) text-sm mb-1">4. Check our Value Score</h3>
            <p class="text-sm text-(--color-text-secondary)">Our Value Score ranks models by quality-per-dollar. High value doesn't mean low quality — it means you're getting the most intelligence for your money.</p>
          </div>
        </div>
      </section>
    </div>

    <div class="mt-8">
      <a
        href={`${base}guides/`}
        class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-(--color-bg-tertiary) text-(--color-text-secondary) hover:text-(--color-text-primary) hover:bg-(--color-bg-hover) transition-colors text-sm"
      >
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        All Guides
      </a>
    </div>
  </article>
</BaseLayout>
