---
import BaseLayout from '../layouts/BaseLayout.astro';
import HeroSection from '../components/HeroSection.astro';
import CategoryCard from '../components/CategoryCard.astro';
import TopModelsPreview from '../components/TopModelsPreview.astro';
import { getLLMModels } from '../data/llm-models';
import { getProvidersWithCounts, getPeople, getBenchmarkMatrix } from '../db/queries';

const models = getLLMModels();
const providers = getProvidersWithCounts();
const people = getPeople();
const benchmarkMatrix = getBenchmarkMatrix();
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;
const lastUpdated = new Date().toLocaleDateString('en-GB', {
  day: 'numeric',
  month: 'short',
  year: 'numeric',
});

const categories = [
  {
    title: 'Large Language Models',
    description: 'Compare GPT, Claude, Gemini, Llama, and more. Sort by price, speed, quality, or value.',
    href: `${base}compare/llm/`,
    modelCount: models.length,
    icon: 'üí¨',
    available: true,
    countLabel: 'models tracked',
  },
  {
    title: 'Benchmarks',
    description: `${benchmarkMatrix.benchmarks.length} benchmarks across ${benchmarkMatrix.models.length} models ‚Äî MMLU, GPQA, HumanEval, SWE-bench, and more.`,
    href: `${base}benchmarks/`,
    modelCount: benchmarkMatrix.benchmarks.length,
    icon: 'üìä',
    available: true,
    countLabel: 'benchmarks tracked',
  },
  {
    title: 'Labs & Providers',
    description: `${providers.length} AI companies and research labs building the models we track.`,
    href: `${base}labs/`,
    modelCount: providers.length,
    icon: 'üè¢',
    available: true,
    countLabel: 'companies listed',
  },
  {
    title: 'People in AI',
    description: `${people.length} researchers, founders, and leaders shaping the future of AI.`,
    href: `${base}people/`,
    modelCount: people.length,
    icon: 'üë§',
    available: true,
    countLabel: 'people profiled',
  },
];
---

<BaseLayout title="The AI Resource Hub ‚Äî Independent AI Model Comparison">
  <HeroSection modelCount={models.length} lastUpdated={lastUpdated} />

  <TopModelsPreview models={models} />

  <!-- Category cards -->
  <section id="categories" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <h2 class="text-2xl font-bold text-(--color-text-primary) mb-2">Browse by Category</h2>
    <p class="text-sm text-(--color-text-secondary) mb-8">Explore AI models across different domains</p>

    <div class="grid sm:grid-cols-2 gap-4">
      {categories.map((cat) => (
        <CategoryCard {...cat} />
      ))}
    </div>
  </section>

  <!-- Stats bar -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="grid grid-cols-2 sm:grid-cols-5 gap-4">
      <div class="text-center p-6 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
        <p class="text-3xl font-bold text-(--color-accent)">{models.length}</p>
        <p class="text-sm text-(--color-text-secondary) mt-1">LLMs Tracked</p>
      </div>
      <div class="text-center p-6 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
        <p class="text-3xl font-bold text-(--color-accent)">{providers.length}</p>
        <p class="text-sm text-(--color-text-secondary) mt-1">Providers</p>
      </div>
      <div class="text-center p-6 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
        <p class="text-3xl font-bold text-(--color-accent)">{benchmarkMatrix.benchmarks.length}</p>
        <p class="text-sm text-(--color-text-secondary) mt-1">Benchmarks</p>
      </div>
      <div class="text-center p-6 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
        <p class="text-3xl font-bold text-(--color-accent)">{people.length}</p>
        <p class="text-sm text-(--color-text-secondary) mt-1">People Profiled</p>
      </div>
      <div class="text-center p-6 rounded-xl bg-(--color-bg-card) border border-(--color-border)">
        <p class="text-3xl font-bold text-(--color-accent)">Free</p>
        <p class="text-sm text-(--color-text-secondary) mt-1">No Paywalls</p>
      </div>
    </div>
  </section>
</BaseLayout>
